
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OWASP Top 10:2021">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.0">
    
    
      
        <title>A10 Server Side Request Forgery (SSRF) - OWASP Top 10:2021</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a102021-ssrf" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../.." title="OWASP Top 10:2021" class="md-header__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Top 10:2021
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A10 Server Side Request Forgery (SSRF)
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../zh_TW/" hreflang="zh_TW" class="md-select__link">
                    繁體中文
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../it/" hreflang="it" class="md-select__link">
                    Italiano
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../pt_BR/" hreflang="pt_BR" class="md-select__link">
                    Português (Brasil)
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../fr/" hreflang="fr" class="md-select__link">
                    Français
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../" hreflang="ja" class="md-select__link">
                    Japanese
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/OWASP/Top10/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Top 10:2021" class="md-nav__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    OWASP Top 10:2021
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/OWASP/Top10/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../0x00-notice/" class="md-nav__link">
        Notice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_Introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="md-nav__link">
        How to use the OWASP Top 10 as a standard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="md-nav__link">
        How to start an AppSec program with the OWASP Top 10
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00-about-owasp/" class="md-nav__link">
        About OWASP
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Top 10:2021 List
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Top 10:2021 List" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Top 10:2021 List
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A01_2021-Broken_Access_Control/" class="md-nav__link">
        A01 Broken Access Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A02_2021-Cryptographic_Failures/" class="md-nav__link">
        A02 Cryptographic Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A03_2021-Injection/" class="md-nav__link">
        A03 Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A04_2021-Insecure_Design/" class="md-nav__link">
        A04 Insecure Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A05_2021-Security_Misconfiguration/" class="md-nav__link">
        A05 Security Misconfiguration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="md-nav__link">
        A06 Vulnerable and Outdated Components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A07_2021-Identification_and_Authentication_Failures/" class="md-nav__link">
        A07 Identification and Authentication Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="md-nav__link">
        A08 Software and Data Integrity Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="md-nav__link">
        A09 Security Logging and Monitoring Failures
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          A10 Server Side Request Forgery (SSRF)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        A10 Server Side Request Forgery (SSRF)
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    因子
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    説明
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    防止方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ネットワーク層から
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    アプリケーション層から:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    攻撃シナリオの例
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    参考資料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cwe" class="md-nav__link">
    対応する CWE のリスト
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A11_2021-Next_Steps/" class="md-nav__link">
        Next Steps
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    因子
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    説明
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    防止方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ネットワーク層から
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    アプリケーション層から:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    攻撃シナリオの例
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    参考資料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cwe" class="md-nav__link">
    対応する CWE のリスト
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/OWASP/Top10/edit/master/docs/A10_2021-Server-Side_Request_Forgery_(SSRF).ja.md" title="編集" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="a102021-ssrf">A10:2021 - サーバーサイドリクエストフォージェリ (SSRF)</h1>
<h2 id="_1">因子</h2>
<table>
<thead>
<tr>
<th align="center">対応する CWE 数</th>
<th align="center">最大発生率</th>
<th align="center">平均発生率</th>
<th align="center">最大網羅率</th>
<th align="center">平均網羅率</th>
<th align="center">加重平均（攻撃の難易度）</th>
<th align="center">加重平均（攻撃による影響）</th>
<th align="center">総発生数</th>
<th align="center">CVE 合計件数</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">2.72%</td>
<td align="center">2.72%</td>
<td align="center">67.72%</td>
<td align="center">67.72%</td>
<td align="center">8.28</td>
<td align="center">6.72</td>
<td align="center">9,503</td>
<td align="center">385</td>
</tr>
</tbody>
</table>
<h2 id="_2">概要</h2>
<p>このカテゴリは業界の調査（第1位）から追加されました。
調査データからわかることは、よくあるテストより広範な範囲において、問題の発生率は比較的低いものの、問題が起きた場合のエクスプロイトとインパクトは平均以上のものとなり得ます。
新しい項目は注意とアウェアネスのために単一または小さなCWEの集合であることが多いので、将来の版にてそれらが注目されより大きなカテゴリとなることが期待されます。</p>
<h2 id="_3">説明</h2>
<p>SSRFの欠陥は、Webアプリケーションがユーザーから提供されたURLを検証することなしにリモートのリソースを取得する場合にもれなく発生します。
ファイアウォールやVPNあるいはその他の種類のネットワークACLによってアプリケーションが保護されている場合でも、SSRFはアプリケーションに対し、意図しない宛先への加工されたリクエストの送信を強要することを可能にします。</p>
<p>モダンなアプリケーションがエンドユーザーに便利な機能を提供するようになり、アプリケーションがURLを取得をすることは珍しくないシナリオとなりした。
その結果、SSRFの発生は増加しています。
またSSRFの深刻度も、クラウドサービスやアーキテクチャの複雑性を背景として、段々と大きくなりつつあります。</p>
<h2 id="_4">防止方法</h2>
<p>開発者は以下の多層防御の制御の一部ないし全てを実装することにより、SSRFを防ぐことができます。</p>
<h2 id="_5"><strong>ネットワーク層から</strong></h2>
<ul>
<li>
<p>SSRFの影響を減らすために、リモートのリソースへアクセスする機能を分離されたネットワークに切り出します。</p>
</li>
<li>
<p>必須のイントラネット通信を除く全ての通信をブロックするために、「デフォルト拒否」のファイアウォールポリシーまたはネットワークアクセス制御を強制します。</p>
</li>
</ul>
<h2 id="_6"><strong>アプリケーション層から:</strong></h2>
<ul>
<li>
<p>クライアントが提供した全ての入力データをサニタイズし、検証します。</p>
</li>
<li>
<p>明確な許可リスト用いてURLスキーム、ポート、宛先を強制します。</p>
</li>
<li>
<p>生のレスポンスをクライアントに送信しないようにします。</p>
</li>
<li>
<p>HTTPのリダイレクトを無効化します。</p>
</li>
<li>
<p>DNSリバインディングや"time of check, time of use" (TOCTOU) 競合状態といった攻撃を防ぐために、URLの整合性に注意します。</p>
</li>
</ul>
<p>拒否リストや正規表現を用いてSSRFを緩和しないでください。攻撃者は拒否リストを回避するためのペイロードのリスト、ツール、そして技術を備えています。</p>
<h2 id="_7">攻撃シナリオの例</h2>
<p>攻撃者は以下のようなシナリオで、Webアプリケーションファイアウォールやファイアウォール、もしくはネットワークACLによって保護されたアプリケーションを攻撃することができます:</p>
<p><strong>シナリオ #1:</strong> 内部サーバーへのポートスキャン。セグメント化されていないネットワークアーキテクチャの場合、攻撃者は内部ネットワークを標的として、SSRFペイロードの接続結果もしくは接続や拒否されるまでにかかった時間をもとに内部サーバーのポートがオープンかクローズかを調べます。</p>
<p><strong>シナリオ #2:</strong> 機微な情報の露出。攻撃者は機微な情報を取得するために、<file:///etc/passwd> のようなローカルファイルまたは内部サーバーにアクセスします。</p>
<p><strong>シナリオ #3:</strong> クラウドサービスのメタデータストレージへのアクセス。多くのクラウドプロバイダは <a href="http://169.254.169.254/">http://169.254.169.254/</a> のようなメタデータストレージを提供しています。攻撃者は機微な情報を取得するためにメタデータを読み取ります。</p>
<p><strong>シナリオ #4:</strong> 内部サービスの乗っ取り - 攻撃者はリモートコード実行 (RCE) やサービス拒否 (DoS) のようなさらなる攻撃を行うために内部サービスを悪用します。</p>
<h2 id="_8">参考資料</h2>
<ul>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html">OWASP - Server-Side Request Forgery Prevention Cheat
    Sheet</a></p>
</li>
<li>
<p><a href="https://portswigger.net/web-security/ssrf">PortSwigger - Server-side request forgery
    (SSRF)</a></p>
</li>
<li>
<p><a href="https://www.acunetix.com/blog/articles/server-side-request-forgery-vulnerability/">Acunetix - What is Server-Side Request Forgery
    (SSRF)?</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/assets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet_SSRF_Bible.pdf">SSRF
    bible</a></p>
</li>
<li>
<p><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming
    Languages!</a></p>
</li>
</ul>
<h2 id="cwe">対応する CWE のリスト</h2>
<p>CWE-918 Server-Side Request Forgery (SSRF)</p>
<h1 id="a102021-server-side-request-forgery-ssrf">A10:2021 – Server-Side Request Forgery (SSRF)    <img align="right" alt="icon" src="../../assets/TOP_10_Icons_Final_SSRF.png" style="height:80px;width:80px" /></h1>
<h2 id="factors">Factors</h2>
<table>
<thead>
<tr>
<th align="center">CWEs Mapped</th>
<th align="center">Max Incidence Rate</th>
<th align="center">Avg Incidence Rate</th>
<th align="center">Avg Weighted Exploit</th>
<th align="center">Avg Weighted Impact</th>
<th align="center">Max Coverage</th>
<th align="center">Avg Coverage</th>
<th align="center">Total Occurrences</th>
<th align="center">Total CVEs</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">2.72%</td>
<td align="center">2.72%</td>
<td align="center">8.28</td>
<td align="center">6.72</td>
<td align="center">67.72%</td>
<td align="center">67.72%</td>
<td align="center">9,503</td>
<td align="center">385</td>
</tr>
</tbody>
</table>
<h2 id="overview">Overview</h2>
<p>This category is added from the Top 10 community survey (#1). The data shows a
relatively low incidence rate with above average testing coverage and
above-average Exploit and Impact potential ratings. As new entries are
likely to be a single or small cluster of Common Weakness Enumerations (CWEs)
for attention and
awareness, the hope is that they are subject to focus and can be rolled
into a larger category in a future edition.</p>
<h2 id="description">Description</h2>
<p>SSRF flaws occur whenever a web application is fetching a remote
resource without validating the user-supplied URL. It allows an attacker
to coerce the application to send a crafted request to an unexpected
destination, even when protected by a firewall, VPN, or another type of
network access control list (ACL).</p>
<p>As modern web applications provide end-users with convenient features,
fetching a URL becomes a common scenario. As a result, the incidence of
SSRF is increasing. Also, the severity of SSRF is becoming higher due to
cloud services and the complexity of architectures.</p>
<h2 id="how-to-prevent">How to Prevent</h2>
<p>Developers can prevent SSRF by implementing some or all the following
defense in depth controls:</p>
<h3 id="from-network-layer"><strong>From Network layer</strong></h3>
<ul>
<li>
<p>Segment remote resource access functionality in separate networks to
    reduce the impact of SSRF</p>
</li>
<li>
<p>Enforce “deny by default” firewall policies or network access
    control rules to block all but essential intranet traffic.<br/>
    <em>Hints:</em><br>
    ~ Establish an ownership and a lifecycle for firewall rules based on applications.<br/>
    ~ Log all accepted <em>and</em> blocked network flows on firewalls
    (see <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/">A09:2021-Security Logging and Monitoring Failures</a>).</p>
</li>
</ul>
<h3 id="from-application-layer"><strong>From Application layer:</strong></h3>
<ul>
<li>
<p>Sanitize and validate all client-supplied input data</p>
</li>
<li>
<p>Enforce the URL schema, port, and destination with a positive allow
    list</p>
</li>
<li>
<p>Do not send raw responses to clients</p>
</li>
<li>
<p>Disable HTTP redirections</p>
</li>
<li>
<p>Be aware of the URL consistency to avoid attacks such as DNS
    rebinding and “time of check, time of use” (TOCTOU) race conditions</p>
</li>
</ul>
<p>Do not mitigate SSRF via the use of a deny list or regular expression.
Attackers have payload lists, tools, and skills to bypass deny lists.</p>
<h3 id="additional-measures-to-consider"><strong>Additional Measures to consider:</strong></h3>
<ul>
<li>
<p>Don't deploy other security relevant services on front systems (e.g. OpenID).
    Control local traffic on these systems (e.g. localhost)</p>
</li>
<li>
<p>For frontends with dedicated and manageable user groups use network encryption (e.g. VPNs)
    on independant systems to consider very high protection needs</p>
</li>
</ul>
<h2 id="example-attack-scenarios">Example Attack Scenarios</h2>
<p>Attackers can use SSRF to attack systems protected behind web
application firewalls, firewalls, or network ACLs, using scenarios such
as:</p>
<p><strong>Scenario #1:</strong> Port scan internal servers – If the network architecture
is unsegmented, attackers can map out internal networks and determine if
ports are open or closed on internal servers from connection results or
elapsed time to connect or reject SSRF payload connections.</p>
<p><strong>Scenario #2:</strong> Sensitive data exposure – Attackers can access local
files such as or internal services to gain sensitive information such
as <code>file:///etc/passwd&lt;/span&gt;</code> and <code>http://localhost:28017/</code>.</p>
<p><strong>Scenario #3:</strong> Access metadata storage of cloud services – Most cloud
providers have metadata storage such as <code>http://169.254.169.254/</code>. An
attacker can read the metadata to gain sensitive information.</p>
<p><strong>Scenario #4:</strong> Compromise internal services – The attacker can abuse
internal services to conduct further attacks such as Remote Code
Execution (RCE) or Denial of Service (DoS).</p>
<h2 id="references">References</h2>
<ul>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html">OWASP - Server-Side Request Forgery Prevention Cheat
    Sheet</a></p>
</li>
<li>
<p><a href="https://portswigger.net/web-security/ssrf">PortSwigger - Server-side request forgery
    (SSRF)</a></p>
</li>
<li>
<p><a href="https://www.acunetix.com/blog/articles/server-side-request-forgery-vulnerability/">Acunetix - What is Server-Side Request Forgery
    (SSRF)?</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/assets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet_SSRF_Bible.pdf">SSRF
    bible</a></p>
</li>
<li>
<p><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming
    Languages!</a></p>
</li>
</ul>
<h2 id="list-of-mapped-cwes">List of Mapped CWEs</h2>
<p><a href="https://cwe.mitre.org/data/definitions/918.html">CWE-918 Server-Side Request Forgery (SSRF)</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="フッター">
      
        
        <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="md-footer__link md-footer__link--prev" aria-label="前: A09 Security Logging and Monitoring Failures" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                前
              </span>
              A09 Security Logging and Monitoring Failures
            </div>
          </div>
        </a>
      
      
        
        <a href="../A11_2021-Next_Steps/" class="md-footer__link md-footer__link--next" aria-label="次: Next Steps" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                次
              </span>
              Next Steps
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>