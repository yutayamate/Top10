
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OWASP Top 10:2021">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.0">
    
    
      
        <title>A04 Insecure Design - OWASP Top 10:2021</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a042021-" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../.." title="OWASP Top 10:2021" class="md-header__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Top 10:2021
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A04 Insecure Design
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../zh_TW/" hreflang="zh_TW" class="md-select__link">
                    繁體中文
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../" hreflang="ja" class="md-select__link">
                    Japanese
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../fr/" hreflang="fr" class="md-select__link">
                    Français
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../pt_BR/" hreflang="pt_BR" class="md-select__link">
                    Português (Brasil)
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../it/" hreflang="it" class="md-select__link">
                    Italiano
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/OWASP/Top10/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Top 10:2021" class="md-nav__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    OWASP Top 10:2021
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/OWASP/Top10/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../0x00-notice/" class="md-nav__link">
        Notice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_Introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="md-nav__link">
        How to use the OWASP Top 10 as a standard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="md-nav__link">
        How to start an AppSec program with the OWASP Top 10
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00-about-owasp/" class="md-nav__link">
        About OWASP
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Top 10:2021 List
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Top 10:2021 List" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Top 10:2021 List
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A01_2021-Broken_Access_Control/" class="md-nav__link">
        A01 Broken Access Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A02_2021-Cryptographic_Failures/" class="md-nav__link">
        A02 Cryptographic Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A03_2021-Injection/" class="md-nav__link">
        A03 Injection
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          A04 Insecure Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        A04 Insecure Design
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    因子
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    説明
  </a>
  
    <nav class="md-nav" aria-label="説明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    要件とリソースマネジメント
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    安全が確認された安心な設計
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-development-lifecycle" class="md-nav__link">
    Secure Development Lifecycle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    防止方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    攻撃シナリオの例
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    参考資料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cwe" class="md-nav__link">
    対応する CWE のリスト
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A05_2021-Security_Misconfiguration/" class="md-nav__link">
        A05 Security Misconfiguration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="md-nav__link">
        A06 Vulnerable and Outdated Components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A07_2021-Identification_and_Authentication_Failures/" class="md-nav__link">
        A07 Identification and Authentication Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="md-nav__link">
        A08 Software and Data Integrity Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="md-nav__link">
        A09 Security Logging and Monitoring Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A10_2021-Server-Side_Request_Forgery_(SSRF)/" class="md-nav__link">
        A10 Server Side Request Forgery (SSRF)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A11_2021-Next_Steps/" class="md-nav__link">
        Next Steps
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    因子
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    説明
  </a>
  
    <nav class="md-nav" aria-label="説明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    要件とリソースマネジメント
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    安全が確認された安心な設計
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-development-lifecycle" class="md-nav__link">
    Secure Development Lifecycle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    防止方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    攻撃シナリオの例
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    参考資料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cwe" class="md-nav__link">
    対応する CWE のリスト
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/OWASP/Top10/edit/master/docs/A04_2021-Insecure_Design.ja.md" title="編集" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="a042021-">A04:2021 - 安全が確認されない不安な設計</h1>
<h2 id="_1">因子</h2>
<table>
<thead>
<tr>
<th align="center">対応する CWE 数</th>
<th align="center">最大発生率</th>
<th align="center">平均発生率</th>
<th align="center">加重平均（攻撃の難易度）</th>
<th align="center">加重平均（攻撃による影響）</th>
<th align="center">最大網羅率</th>
<th align="center">平均網羅率</th>
<th align="center">総発生数</th>
<th align="center">CVE 合計件数</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">40</td>
<td align="center">24.19%</td>
<td align="center">3.00%</td>
<td align="center">6.46</td>
<td align="center">6.78</td>
<td align="center">77.25%</td>
<td align="center">42.51%</td>
<td align="center">262,407</td>
<td align="center">2,691</td>
</tr>
</tbody>
</table>
<h2 id="_2">概要</h2>
<p>2021年の新カテゴリーでは、設計やアーキテクチャの欠陥に関するリスクに焦点を当てています。
私たちは脅威のモデル化、セキュアなデザインパターンおよび、リファレンスアーキテクチャなどをもっと利用していくことが必要です。
注目すべき CWE (Common Weakness Enumerations) は、CWE-209: エラーメッセージからの情報漏洩、CWE-256: 保護されていない認証情報の保存、CWE-501: 信頼境界線の侵害および、CWE-522: 適切に保護されていないクレデンシャル などです。</p>
<h2 id="_3">説明</h2>
<p>「安全が確認されない不安な設計」とは、様々な弱点を表す幅広いカテゴリーで、「安全な設計が行われていない」または、「効果的ではない設計が行われている」と表現されます。
「安全な設計が行われていない」とは、管理策が欠如していることを意味します。例として、センシティブなデータを暗号化すべきコードに、暗号化するためのメソッドがない場合があげられます。
「効果的ではない設計が行われている」とは、攻撃者が脅威を発生させる可能性があるにもかかわらず、ドメイン（ビジネス）ロジックの検証が不十分であるために、リスクが顕在化する場合を意味します。
例として、所得区分に基づいてパンデミック税の軽減措置を処理することになっているドメインロジックが、すべての入力が正しく署名されているかどうかを検証しておらず、本来付与されるべきものよりもはるかに大きな軽減措置を提供している場合が挙げられます。</p>
<h3 id="_4">要件とリソースマネジメント</h3>
<p>すべてのデータ資産の機密性、真正性、完全性、可用性に関する保護要件および、期待されるビジネスロジックなど、アプリケーションのビジネス要件を収集し、事業部門と協議します。
アプリケーションが公開される程度に応じて、（アクセス制御に加えて）テナントを分離する必要があるか検討してください。
機能的および非機能的なセキュリティ要件を含む、技術的な要件をまとめます。
セキュリティ活動を含む設計、構築、テストおよび、運用のすべてをカバーする予算を計画し、事業部門と協議します。</p>
<h3 id="_5">安全が確認された安心な設計</h3>
<p>「安全が確認された安心な設計」とは、常に脅威を評価し、既知の攻撃方法を防ぐためにコードを堅牢に設計し、テストする文化と方法論のことです。
データフローやアクセスコントロールなどのセキュリティコントロールの変更を確認するセッション（または同様の活動）に脅威のモデル化を統合するべきです。
ユーザストーリーの開発においては、正常なフロー及び障害の状態を決定し、責任者および、影響を受ける当事者がそれらを十分に理解し合意していることを確認してください。
正常系と異常系のフローの仮説と条件を分析し、それらが正確であり期待される物であることを確認します。仮説を検証し、適切な動作に必要な条件を実行する方法を決定し、結果をユーザーストーリーとして確実に文書化しましょう。
失敗から学び、改善を促進するための積極的なインセンティブを提供していくことが肝要です。「安全が確認された安心な設計」とは、ソフトウェアに追加できるアドオンでもツールでもありません。</p>
<h3 id="secure-development-lifecycle">Secure Development Lifecycle</h3>
<p>「安全が確認された安心なソフトウェア」を実現するには、セキュア開発ライフサイクル、何らかのセキュアデザインパターン、「ペイブド・ロード」方法論、安全なコンポーネントライブラリ、ツール、および脅威のモデル化が必要です。
全てのソフトウェアの開発プロジェクトとメンテナンス期間を通して、ソフトウェアプロジェクトの開始時にセキュリティの専門家に声をかけてください。
<a href="https://owaspsamm.org">OWASP ソフトウエアセキュリティ保証成熟度モデル(OWASP SAMM)</a> を活用して、安全なソフトウェア開発に取り組みましょう。</p>
<h2 id="_6">防止方法</h2>
<ul>
<li>
<p>セキュリティおよびプライバシー関連の管理策の評価および設計を支援するために、アプリケーションセキュリティの専門家とともにセキュアな開発ライフサイクルを確立し使用する</p>
</li>
<li>
<p>セキュアなデザインパターンまたは、信頼性が高く安全性も検証されているコンポーネントライブラリを構築し使用する</p>
</li>
<li>
<p>重要な認証、アクセスコントロール、ビジネスロジック、および暗号鍵の管理フローに脅威モデルを使用する</p>
</li>
<li>
<p>ユーザーストーリーにセキュリティ言語とコントロールを組み込む</p>
</li>
<li>
<p>(フロントエンドからバックエンドまで)アプリケーションの各層に妥当性チェックを統合する</p>
</li>
<li>
<p>ユニットテストおよび統合テストを実施し、すべての重要なフローが脅威モデルに対して耐性があることを検証する。アプリケーションの各階層のユースケース<em>と</em>ミスユースケースをまとめる</p>
</li>
<li>
<p>リスク管理における保護の必要性に応じて、システム層とネットワーク層の階層を分ける</p>
</li>
<li>
<p>すべての階層でテナントを分離した堅牢な設計を行う</p>
</li>
<li>
<p>ユーザーやサービスによる過剰なリソース消費を制限する</p>
</li>
</ul>
<h2 id="_7">攻撃シナリオの例</h2>
<p><strong>シナリオ #1:</strong> </p>
<p>クレデンシャルの回復フローには「秘密の質問と答え」が含まれることがあります。
「秘密の質問と答え」は、NIST 800-63b、OWASP ASVS、および OWASP Top 10 で禁止されています。
「秘密の質問と答え」は複数の人が答えを知ることができるため、アイデンティティの証拠として信頼できないためです。
このようなコードは削除し、より安全な設計に置き換えるべきです。</p>
<p><strong>シナリオ #2:</strong> </p>
<p>ある映画館チェーンでは団体予約による割引を認めており、最大 15 名までは予約保証金が必要ありません。
攻撃者は、このフローに対する脅威モデルを作成し、数回のリクエストで600席とすべての映画館を一度に予約できるかどうかをテストし、大規模な損失を引き起こすことができます。</p>
<p><strong>シナリオ #3:</strong> </p>
<p>ある小売チェーンの電子商取引サイトでは、ダフ屋がオークションサイトに転売するために高級ビデオカードを購入するボットへの対策がなされていません。
この結果、ビデオカードメーカーや小売チェーン店にとっては最悪の評判となり、これらのカードをまったく手に入れることができない熱狂的なファンにとっては不幸をもたらします。
注意深いボット対策の設計や、入手可能になってから数秒以内に購入された場合などのドメインロジックを作成することで、非正規の購入を識別し、そのような取引を拒否することができるかもしれません。</p>
<h2 id="_8">参考資料</h2>
<ul>
<li>
<p><a href="Coming Soon">OWASP Cheat Sheet: Secure Design Principles</a></p>
</li>
<li>
<p><a href="https://owaspsamm.org/model/design/security-architecture/">OWASP SAMM: Design:Security Architecture</a></p>
</li>
<li>
<p><a href="https://owaspsamm.org/model/design/threat-assessment/">OWASP SAMM: Design:Threat Assessment</a> </p>
</li>
<li>
<p><a href="https://www.nist.gov/system/files/documents/2021/07/13/Developer%20Verification%20of%20Software.pdf">NIST – Guidelines on Minimum Standards for Developer Verification of Software</a></p>
</li>
<li>
<p><a href="https://threatmodelingmanifesto.org">The Threat Modeling Manifesto</a></p>
</li>
<li>
<p><a href="https://github.com/hysnsec/awesome-threat-modelling">Awesome Threat Modeling</a></p>
</li>
</ul>
<h2 id="cwe">対応する CWE のリスト</h2>
<p><a href="https://cwe.mitre.org/data/definitions/73.html">CWE-73 ファイル名やパス名の外部制御</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/183.html">CWE-183 許容範囲が広すぎる入力制限</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/209.html">CWE-209 エラーメッセージからの情報漏洩</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/213.html">CWE-213 互換性のないポリシーによる機密情報の漏洩</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/235.html">CWE-235 想定を超えたパラメータの不適切な処理</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/256.html">CWE-256 パスワードなどのアカウント情報が平文のまま格納されている問題</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/257.html">CWE-257 復元可能な形式で保存されたパスワード</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/266.html">CWE-266 不正確な特権の割り当て</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/269.html">CWE-269 不適切な特権管理</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/280.html">CWE-280 権限管理の不備</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311 重要な情報を暗号化していない問題</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312 重要な情報が平文のまま格納されている問題</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/313.html">CWE-313 ファイルやディスクに平文のまま格納されている問題</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/316.html">CWE-316 メモリ上に平文のまま格納されている問題</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/419.html">CWE-419 保護されていないプライマリーチャネル</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/430.html">CWE-430 誤ったハンドラーの配置</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434 適切でないアップロートファイル制限</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/444.html">CWE-444 HTTPリクエストの矛盾した解釈（HTTPリクエストスマグリング）</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/451.html">CWE-451 ユーザーインターフェース（UI）による重要情報の誤表示</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/472.html">CWE-472 不変と仮定される Web パラメータの外部制御</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/501.html">CWE-501 信頼境界線の侵害</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/522.html">CWE-522 十分でない資格情報保護</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/525.html">CWE-525 機密情報を含むWebブラウザのキャッシュの使用</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/539.html">CWE-539 機密情報を含むパーシステントクッキーの使用</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/579.html">CWE-579 J2EEのバッドプラクティス：セッションに格納されたシリアライズ不可能なオブジェクト</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598 GETリクエストのクエリ文字列からの情報漏洩</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/602.html">CWE-602 サーバサイドのセキュリティをクライアントサイドで実施</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/642.html">CWE-642 重要な状態データの外部制御</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/646.html">CWE-646 外部から提供されたファイルのファイル名や拡張子への依存</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/650.html">CWE-650 サーバーサイドにおける HTTP メソッドへの過剰な信頼</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/653.html">CWE-653 不十分なコンパートメント化</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/656.html">CWE-656 隠ぺいによるセキュリティへの依存</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/657.html">CWE-657 セキュリティ設計原則の違反</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/799.html">CWE-799 適切でない相互作用に対する頻度制御</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/807.html">CWE-807 信頼できない入力に基づいた判断への依存</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/840.html">CWE-840 ビジネスロジックのエラー</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/841.html">CWE-841 ユーザーの振る舞いに基づいたワークフローに依存した不適切な処理の実施</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/927.html">CWE-927 センシティブなコミュニケーションへの暗黙的インテントの使用</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1021.html">CWE-1021 レンダリングされたUIレイヤーやフレームの不適切な制限</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1173.html">CWE-1173 バリデーションフレームワークの不適切な使用</a></p>
<h1 id="a042021-insecure-design">A04:2021 – Insecure Design   <img align="right" alt="icon" src="../../assets/TOP_10_Icons_Final_Insecure_Design.png" style="height:80px;width:80px" /></h1>
<h2 id="factors">Factors</h2>
<table>
<thead>
<tr>
<th align="center">CWEs Mapped</th>
<th align="center">Max Incidence Rate</th>
<th align="center">Avg Incidence Rate</th>
<th align="center">Avg Weighted Exploit</th>
<th align="center">Avg Weighted Impact</th>
<th align="center">Max Coverage</th>
<th align="center">Avg Coverage</th>
<th align="center">Total Occurrences</th>
<th align="center">Total CVEs</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">40</td>
<td align="center">24.19%</td>
<td align="center">3.00%</td>
<td align="center">6.46</td>
<td align="center">6.78</td>
<td align="center">77.25%</td>
<td align="center">42.51%</td>
<td align="center">262,407</td>
<td align="center">2,691</td>
</tr>
</tbody>
</table>
<h2 id="overview">Overview</h2>
<p>A new category for 2021 focuses on risks related to design and
architectural flaws, with a call for more use of threat modeling, secure
design patterns, and reference architectures. Notable Common Weakness Enumerations (CWEs) include
<em>CWE-209: Generation of Error Message Containing Sensitive Information</em>,
<em>CWE-256: Unprotected Storage of Credentials</em>, <em>CWE-501: Trust Boundary
Violation</em>, and <em>CWE-522: Insufficiently Protected Credentials</em>.</p>
<h2 id="description">Description</h2>
<p>Insecure design is a broad category representing many different
weaknesses, expressed as “missing or ineffective control design.”
Missing insecure design is where a control is absent. For example,
imagine code that should be encrypting sensitive data, but there is no
method. Ineffective insecure design is where an attacker could realize a threat,
but insufficient domain (business) logic validation prevents the action.
For example, imagine domain logic that is supposed to process pandemic
tax relief based upon income brackets but does not validate that all
inputs are correctly signed and provides a much more significant relief
benefit than should be granted.</p>
<h3 id="requirements-and-resource-management">Requirements and Resource Management</h3>
<p>Collect and negotiate the business requirements for an application with the
business, including the protection requirements concerning confidentiality,
authenticity, integrity, availability of all data assets, and the expected
business logic. Take into account how exposed your application will be and
if you need segregation of tenants (additionally to access control). Compile
the technical requirements, including functional and non-functional security
requirements. Plan and negotiate the budget covering all design, build,
testing, and operation, including security activities.</p>
<h3 id="secure-design">Secure Design</h3>
<p>Secure design is a culture and methodology that constantly evaluates threats and ensures that code is robustly designed and tested to prevent known attack methods. Threat modeling should be integrated into refinement sessions (or similar activities); look for changes in data flows and access control or other security controls. In the user story development determine the correct flow and failure states, ensure they are well understood and agreed upon by responsible and impacted parties. Analyze assumptions and conditions for expected and failure flows, ensure they are still accurate and desirable. Determine how to validate the assumptions and enforce conditions needed for proper behaviors. Ensure the results are documented in the user story. Learn from mistakes and offer positive incentives to promote improvements. Secure design is neither an add-on nor a tool that you can add to software.</p>
<h3 id="secure-development-lifecycle_1">Secure Development Lifecycle</h3>
<p>Secure software requires a secure development lifecycle, some form of secure design pattern, paved road methodology, secured component library, tooling, and threat modeling. Reach out for your security specialists at the beginning of a software project throughout the whole project and maintenance of your software. Consider leveraging the <a href="https://owaspsamm.org">OWASP Software Assurance Maturity Model (SAMM)</a> to help structure your secure software development efforts.</p>
<h2 id="how-to-prevent">How to Prevent</h2>
<ul>
<li>
<p>Establish and use a secure development lifecycle with AppSec
    professionals to help evaluate and design security and
    privacy-related controls</p>
</li>
<li>
<p>Establish and use a library of secure design patterns or paved road
    ready to use components</p>
</li>
<li>
<p>Use threat modeling for critical authentication, access control,
    business logic, and key flows</p>
</li>
<li>
<p>Integrate security language and controls into user stories</p>
</li>
<li>
<p>Integrate plausibility checks at each tier of your application
    (from frontend to backend)</p>
</li>
<li>
<p>Write unit and integration tests to validate that all critical flows
    are resistant to the threat model. Compile use-cases <em>and</em> misuse-cases
    for each tier of your application.</p>
</li>
<li>
<p>Segregate tier layers on the system and network layers depending on the 
    exposure and protection needs</p>
</li>
<li>
<p>Segregate tenants robustly by design throughout all tiers</p>
</li>
<li>
<p>Limit resource consumption by user or service</p>
</li>
</ul>
<h2 id="example-attack-scenarios">Example Attack Scenarios</h2>
<p><strong>Scenario #1:</strong> A credential recovery workflow might include “questions
and answers,” which is prohibited by NIST 800-63b, the OWASP ASVS, and
the OWASP Top 10. Questions and answers cannot be trusted as evidence of
identity as more than one person can know the answers, which is why they
are prohibited. Such code should be removed and replaced with a more
secure design.</p>
<p><strong>Scenario #2:</strong> A cinema chain allows group booking discounts and has a
maximum of fifteen attendees before requiring a deposit. Attackers could
threat model this flow and test if they could book six hundred seats and
all cinemas at once in a few requests, causing a massive loss of income.</p>
<p><strong>Scenario #3:</strong> A retail chain’s e-commerce website does not have
protection against bots run by scalpers buying high-end video cards to
resell auction websites. This creates terrible publicity for the video
card makers and retail chain owners and enduring bad blood with
enthusiasts who cannot obtain these cards at any price. Careful anti-bot
design and domain logic rules, such as purchases made within a few
seconds of availability, might identify inauthentic purchases and
rejected such transactions.</p>
<h2 id="references">References</h2>
<ul>
<li>
<p><a href="Coming Soon">OWASP Cheat Sheet: Secure Design Principles</a></p>
</li>
<li>
<p><a href="https://owaspsamm.org/model/design/security-architecture/">OWASP SAMM: Design:Security Architecture</a></p>
</li>
<li>
<p><a href="https://owaspsamm.org/model/design/threat-assessment/">OWASP SAMM: Design:Threat Assessment</a> </p>
</li>
<li>
<p><a href="https://www.nist.gov/system/files/documents/2021/07/13/Developer%20Verification%20of%20Software.pdf">NIST – Guidelines on Minimum Standards for Developer Verification of Software</a></p>
</li>
<li>
<p><a href="https://threatmodelingmanifesto.org">The Threat Modeling Manifesto</a></p>
</li>
<li>
<p><a href="https://github.com/hysnsec/awesome-threat-modelling">Awesome Threat Modeling</a></p>
</li>
</ul>
<h2 id="list-of-mapped-cwes">List of Mapped CWEs</h2>
<p><a href="https://cwe.mitre.org/data/definitions/73.html">CWE-73 External Control of File Name or Path</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/183.html">CWE-183 Permissive List of Allowed Inputs</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/209.html">CWE-209 Generation of Error Message Containing Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/213.html">CWE-213 Exposure of Sensitive Information Due to Incompatible Policies</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/235.html">CWE-235 Improper Handling of Extra Parameters</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/256.html">CWE-256 Unprotected Storage of Credentials</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/257.html">CWE-257 Storing Passwords in a Recoverable Format</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/266.html">CWE-266 Incorrect Privilege Assignment</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/269.html">CWE-269 Improper Privilege Management</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/280.html">CWE-280 Improper Handling of Insufficient Permissions or Privileges</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311 Missing Encryption of Sensitive Data</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312 Cleartext Storage of Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/313.html">CWE-313 Cleartext Storage in a File or on Disk</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/316.html">CWE-316 Cleartext Storage of Sensitive Information in Memory</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/419.html">CWE-419 Unprotected Primary Channel</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/430.html">CWE-430 Deployment of Wrong Handler</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434 Unrestricted Upload of File with Dangerous Type</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/444.html">CWE-444 Inconsistent Interpretation of HTTP Requests ('HTTP Request Smuggling')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/451.html">CWE-451 User Interface (UI) Misrepresentation of Critical Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/472.html">CWE-472 External Control of Assumed-Immutable Web Parameter</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/501.html">CWE-501 Trust Boundary Violation</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/522.html">CWE-522 Insufficiently Protected Credentials</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/525.html">CWE-525 Use of Web Browser Cache Containing Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/539.html">CWE-539 Use of Persistent Cookies Containing Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/579.html">CWE-579 J2EE Bad Practices: Non-serializable Object Stored in Session</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598 Use of GET Request Method With Sensitive Query Strings</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/602.html">CWE-602 Client-Side Enforcement of Server-Side Security</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/642.html">CWE-642 External Control of Critical State Data</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/646.html">CWE-646 Reliance on File Name or Extension of Externally-Supplied File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/650.html">CWE-650 Trusting HTTP Permission Methods on the Server Side</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/653.html">CWE-653 Insufficient Compartmentalization</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/656.html">CWE-656 Reliance on Security Through Obscurity</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/657.html">CWE-657 Violation of Secure Design Principles</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/799.html">CWE-799 Improper Control of Interaction Frequency</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/807.html">CWE-807 Reliance on Untrusted Inputs in a Security Decision</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/840.html">CWE-840 Business Logic Errors</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/841.html">CWE-841 Improper Enforcement of Behavioral Workflow</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/927.html">CWE-927 Use of Implicit Intent for Sensitive Communication</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1021.html">CWE-1021 Improper Restriction of Rendered UI Layers or Frames</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1173.html">CWE-1173 Improper Use of Validation Framework</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="フッター">
      
        
        <a href="../A03_2021-Injection/" class="md-footer__link md-footer__link--prev" aria-label="前: A03 Injection" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                前
              </span>
              A03 Injection
            </div>
          </div>
        </a>
      
      
        
        <a href="../A05_2021-Security_Misconfiguration/" class="md-footer__link md-footer__link--next" aria-label="次: A05 Security Misconfiguration" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                次
              </span>
              A05 Security Misconfiguration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>